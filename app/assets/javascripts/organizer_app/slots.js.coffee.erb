module = angular.module('organizer.slots', [])

module.directive 'scheduleSessionSlot', ->
  restrict: 'A'
  templateUrl: '<%= asset_path('organizer_app/session_slot.html') %>'
  scope: { clear: '&sessionRemove', time: '=', session: '=' }
  link: ($scope, element, attributes) ->
    element.attr('rowspan', $scope.session.timeSlotSpan)

module.directive 'scheduleBlankSlot', ->
    restrict: 'A'
    templateUrl: '<%= asset_path('organizer_app/blank_slot.html') %>'
    scope: { submit: '&sessionAdd', time: '=', sessions: '=' }
    controller: [
      'Editor', '$scope',
      (Editor, $scope) ->
        $scope.control = {
          edit: ->
            Editor.edit($scope.time)
          reset: (form) ->
            $scope.sessionToAdd = ''
            form.$setPristine()
            Editor.clear()
        }

        return
    ]

module.directive 'focusOn', ($timeout) ->
  restrict: 'A'
  link: (scope, element, attrs) ->
    scope.$watch attrs.focusOn, (value) ->
      if value
        $timeout -> element[0].focus()
